require File.dirname(__FILE__) + '/../test_helper'
<% model_name = name.classify -%>

class <%= model_name %>Test < ActiveSupport::TestCase
  
  def test_should_create_<%= name %>
    assert_difference '<%= model_name %>.count' do
      <%= name %> = create_<%= name %>
      assert !<%= name %>.new_record?, "#{<%= name %>.errors.full_messages.to_sentence}"
    end
  end

  private
  
  def create_<%= name %>(options = {}, widget_type_options = {})
    widget_type_options.reverse_merge!({
      :name => "Test <%= name %>",
      :key => "<%= name %>", 
      :subclass_type => "<%= model_name %>",
    })  
    widget_type = Widget.create!(widget_type_options)
    default_options = {
      :name => "Test <%= name %>", 
      :block => blocks(:one),
      :widget_type => widget_type,
      # Insert other options for widget here
    }
    <%= model_name %>.create(default_options.merge(options))
  end
end
